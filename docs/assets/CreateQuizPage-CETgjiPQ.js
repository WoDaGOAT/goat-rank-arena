import{c as J,j as e,l as _,m as T,ab as q,bc as R,a4 as E,n as S,aG as u,aH as c,aI as x,aJ as d,I as j,aK as h,bd as U,be as B,B as N,z as W,bf as K,a6 as Y,bg as Q,bh as D,bi as F,bj as k,bk as y,bl as v,b1 as C,b4 as z,x as $,bm as G,bn as Z,aV as X,bo as ee,G as l,b as se,e as ae,aE as te,aL as re,o as le,s as ie,J as M,aF as ne,at as oe,L as ce,C as de}from"./index-D6Dh-tOY.js";import{C as ue}from"./calendar-Cp1CsHJb.js";import{C as L}from"./calendar-BKtBvoYG.js";import{f as P}from"./format-BHf82gLm.js";import{C as me,R as xe,a as he}from"./radio-group-C3QFr_Z3.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=J("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),ge=({form:s})=>e.jsxs(_,{className:"bg-white shadow-xl border border-gray-200",children:[e.jsxs(T,{className:"border-b border-gray-100",children:[e.jsxs(q,{className:"flex items-center gap-2 text-gray-800",children:[e.jsx(R,{className:"h-5 w-5 text-blue-600"}),"Quiz Details"]}),e.jsx(E,{className:"text-gray-600",children:"Create a new 5-question daily quiz for WoDaGOAT users"})]}),e.jsxs(S,{className:"space-y-6 pt-6 bg-white",children:[e.jsx(u,{control:s.control,name:"title",render:({field:a})=>e.jsxs(c,{children:[e.jsx(x,{className:"text-gray-700 font-medium",children:"Quiz Title"}),e.jsx(d,{children:e.jsx(j,{placeholder:"e.g., Premier League Trivia",...a,className:"bg-gray-50 border-gray-300 focus:border-blue-500 focus:ring-blue-500/20"})}),e.jsx(h,{})]})}),e.jsx(u,{control:s.control,name:"topic",render:({field:a})=>e.jsxs(c,{children:[e.jsx(x,{className:"text-gray-700 font-medium",children:"Topic (Optional)"}),e.jsx(d,{children:e.jsx(j,{placeholder:"e.g., Football",...a,className:"bg-gray-50 border-gray-300 focus:border-blue-500 focus:ring-blue-500/20"})}),e.jsx(h,{})]})}),e.jsx(u,{control:s.control,name:"active_date",render:({field:a})=>e.jsxs(c,{className:"flex flex-col",children:[e.jsx(x,{className:"text-gray-700 font-medium",children:"Active Date"}),e.jsxs(U,{children:[e.jsx(B,{asChild:!0,children:e.jsx(d,{children:e.jsxs(N,{variant:"outline",className:W("w-[240px] pl-3 text-left font-normal bg-gray-50 border-gray-300 hover:bg-gray-100",!a.value&&"text-muted-foreground"),children:[a.value?P(a.value,"PPP"):e.jsx("span",{children:"Pick a date"}),e.jsx(L,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(K,{className:"w-auto p-0 bg-white shadow-xl border",align:"start",children:e.jsx(ue,{mode:"single",selected:a.value,onSelect:a.onChange,disabled:r=>r<new Date,initialFocus:!0})})]}),e.jsx(h,{})]})})]})]}),pe=[{value:"UTC",label:"UTC (Coordinated Universal Time)"},{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"Europe/London",label:"Greenwich Mean Time (GMT)"},{value:"Europe/Paris",label:"Central European Time (CET)"},{value:"Asia/Tokyo",label:"Japan Standard Time (JST)"},{value:"Asia/Shanghai",label:"China Standard Time (CST)"},{value:"Australia/Sydney",label:"Australian Eastern Time (AET)"}],je=s=>{switch(s){case"draft":return"Save quiz without publishing";case"scheduled":return"Schedule quiz for automatic publication";case"published":return"Publish quiz immediately";default:return""}},we=({form:s})=>{const a=s.watch("active_date"),r=s.watch("publication_time"),g=s.watch("timezone"),m=s.watch("status");return e.jsxs(_,{className:"bg-white shadow-xl border border-gray-200",children:[e.jsxs(T,{className:"border-b border-gray-100",children:[e.jsxs(q,{className:"flex items-center gap-2 text-gray-800",children:[e.jsx(Y,{className:"h-5 w-5 text-purple-600"}),"Publication Settings"]}),e.jsx(E,{className:"text-gray-600",children:"Configure when and how this quiz will be published"})]}),e.jsxs(S,{className:"space-y-6 pt-6 bg-white",children:[e.jsx(u,{control:s.control,name:"status",render:({field:i})=>e.jsxs(c,{children:[e.jsx(x,{className:"text-gray-700 font-medium",children:"Publication Status"}),e.jsxs(Q,{onValueChange:i.onChange,value:i.value,children:[e.jsx(d,{children:e.jsx(D,{className:"bg-gray-50 border-gray-300 focus:border-purple-500",children:e.jsx(F,{placeholder:"Select publication status"})})}),e.jsxs(k,{className:"bg-white shadow-xl border",children:[e.jsx(y,{value:"draft",children:"ðŸ“ Draft"}),e.jsx(y,{value:"scheduled",children:"â° Scheduled"}),e.jsx(y,{value:"published",children:"ðŸš€ Published"})]})]}),e.jsx(v,{className:"text-gray-500",children:je(i.value)}),e.jsx(h,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{control:s.control,name:"publication_time",render:({field:i})=>e.jsxs(c,{children:[e.jsx(x,{className:"text-gray-700 font-medium",children:"Publication Time"}),e.jsx(d,{children:e.jsx(j,{type:"time",...i,className:"w-full bg-gray-50 border-gray-300 focus:border-purple-500"})}),e.jsx(v,{className:"text-gray-500",children:"Time when the quiz will be published"}),e.jsx(h,{})]})}),e.jsx(u,{control:s.control,name:"timezone",render:({field:i})=>e.jsxs(c,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-gray-700 font-medium",children:[e.jsx(be,{className:"h-4 w-4"}),"Timezone"]}),e.jsxs(Q,{onValueChange:i.onChange,value:i.value,children:[e.jsx(d,{children:e.jsx(D,{className:"bg-gray-50 border-gray-300 focus:border-purple-500",children:e.jsx(F,{placeholder:"Select timezone"})})}),e.jsx(k,{className:"max-h-60 bg-white shadow-xl border",children:pe.map(n=>e.jsx(y,{value:n.value,children:n.label},n.value))})]}),e.jsx(v,{className:"text-gray-500",children:"Timezone for publication time"}),e.jsx(h,{})]})})]}),m==="scheduled"&&a&&e.jsxs(C,{className:"bg-yellow-50 border-yellow-200 shadow-sm",children:[e.jsx(L,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(z,{className:"text-yellow-800",children:[e.jsx("strong",{children:"Scheduled Publication:"})," This quiz will be automatically published on"," ",P(a,"PPP")," at ",r," (",g,")."]})]}),m==="published"&&e.jsxs(C,{className:"bg-green-50 border-green-200 shadow-sm",children:[e.jsx($,{className:"h-4 w-4 text-green-600"}),e.jsxs(z,{className:"text-green-800",children:[e.jsx("strong",{children:"Immediate Publication:"})," This quiz will be published immediately and available to users."]})]})]})]})},ye=({form:s,questionIndex:a})=>{const{fields:r,append:g,remove:m}=G({control:s.control,name:`questions.${a}.answers`}),i=s.watch(`questions.${a}.question_text`),n=i&&i.trim().length>0;return e.jsxs(_,{className:"bg-white shadow-lg border border-gray-200 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 to-purple-500"}),e.jsx(T,{className:"border-b border-gray-100 bg-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(q,{className:"text-lg flex items-center gap-2 text-gray-800",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${n?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:n?e.jsx(me,{className:"h-4 w-4"}):a+1}),"Question ",a+1," of 5"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-xs text-purple-600 bg-purple-50 px-2 py-1 rounded-full font-medium",children:"1 point"}),n&&e.jsx("div",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded-full font-medium",children:"âœ“ Complete"})]})]})}),e.jsxs(S,{className:"space-y-6 pt-6 bg-white",children:[e.jsx(u,{control:s.control,name:`questions.${a}.question_text`,render:({field:t})=>e.jsxs(c,{children:[e.jsxs(x,{className:"text-gray-700 font-medium flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-blue-500"}),"Question Text"]}),e.jsx(d,{children:e.jsx(j,{placeholder:"What is the question?",...t,className:"bg-gray-50 border-gray-300 focus:border-blue-500 focus:ring-blue-500/20"})}),e.jsx(h,{})]})}),e.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-blue-100",children:[e.jsx(u,{control:s.control,name:`questions.${a}.correct_answer_index`,render:({field:t})=>{var o;return e.jsxs(c,{className:"space-y-3",children:[e.jsx(x,{className:"text-gray-700 font-medium",children:"Answer Options (select the correct one)"}),e.jsx(d,{children:e.jsx(xe,{onValueChange:b=>t.onChange(parseInt(b)),value:((o=t.value)==null?void 0:o.toString())||"0",className:"space-y-3",children:r.map((b,p)=>e.jsxs(c,{className:"flex items-center space-x-3 space-y-0 p-3 rounded-lg bg-gray-50 border border-gray-200",children:[e.jsx(d,{children:e.jsx(he,{value:p.toString(),className:"text-blue-600"})}),e.jsx(u,{control:s.control,name:`questions.${a}.answers.${p}.answer_text`,render:({field:w})=>e.jsx(c,{className:"flex-grow",children:e.jsx(d,{children:e.jsx(j,{placeholder:`Answer ${p+1}`,...w,className:"bg-white border-gray-300 focus:border-blue-500"})})})}),r.length>2&&e.jsx(N,{type:"button",size:"icon",variant:"ghost",onClick:()=>m(p),className:"shrink-0 text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(X,{className:"h-4 w-4"})})]},b.id))})}),e.jsx(h,{})]})}}),r.length<6&&e.jsxs(N,{type:"button",size:"sm",variant:"ghost",onClick:()=>g({answer_text:""}),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Add Answer Option"]})]})]})]})},Ne=l.object({answer_text:l.string().min(1,"Answer text cannot be empty.")}),fe=l.object({question_text:l.string().min(1,"Question text cannot be empty."),answers:l.array(Ne).min(2,"Must have at least two answers."),correct_answer_index:l.number().min(0,"A correct answer must be selected.")}),ve=l.object({title:l.string().min(3,"Title must be at least 3 characters."),topic:l.string().optional(),active_date:l.date({required_error:"An active date is required."}),status:l.enum(["draft","scheduled","published"],{required_error:"Please select a status."}),timezone:l.string().default("UTC"),publication_time:l.string().regex(/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/,"Invalid time format (HH:MM)"),questions:l.array(fe).length(5,"Daily quizzes must have exactly 5 questions.")}),Ce=()=>{const s=new Date;return s.setDate(s.getDate()+1),{title:"",topic:"",active_date:s,status:"draft",timezone:"UTC",publication_time:"09:00",questions:Array(5).fill(null).map(()=>({question_text:"",answers:[{answer_text:""},{answer_text:""}],correct_answer_index:0}))}},ze=()=>{const s=se(),a=ae(),r=te({resolver:re(ve),defaultValues:Ce()}),{fields:g}=G({control:r.control,name:"questions"}),m=le({mutationFn:async t=>{const o=t.questions.map((f,V)=>({question_text:f.question_text,order:V+1,answers:f.answers.map((H,I)=>({answer_text:H.answer_text,is_correct:f.correct_answer_index===I}))})),[b,p]=t.publication_time.split(":").map(Number),w=new Date(t.active_date);w.setHours(b,p,0,0);const{data:O,error:A}=await ie.rpc("create_quiz",{p_title:t.title,p_topic:t.topic||null,p_active_date:P(t.active_date,"yyyy-MM-dd"),p_questions:o,p_publication_datetime:w.toISOString(),p_status:t.status,p_timezone:t.timezone});if(A)throw A;return O},onSuccess:(t,o)=>{const b=o.status==="published"?"published":o.status==="scheduled"?"scheduled":"saved as draft";M.success(`5-question daily quiz ${b} successfully!`),a.invalidateQueries({queryKey:["todaysQuiz"]}),s("/quiz")},onError:t=>{M.error("Failed to create quiz.",{description:t.message})}});function i(t){m.mutate(t)}const n=g.filter((t,o)=>r.watch(`questions.${o}.question_text`)).length;return e.jsx("div",{className:"space-y-8",children:e.jsx(ne,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(i),className:"space-y-8",children:[e.jsxs(C,{className:"bg-blue-50 border-blue-200 shadow-sm",children:[e.jsx($,{className:"h-4 w-4 text-blue-600"}),e.jsxs(z,{className:"text-blue-800",children:[e.jsx("strong",{children:"Daily Quiz Format:"})," All daily quizzes must have exactly 5 questions. Each question awards 1 point for a maximum score of 5 points per quiz."]})]}),e.jsx(ge,{form:r}),e.jsx(we,{form:r}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:["Questions (5 Required)",n===5&&e.jsx(oe,{className:"h-5 w-5 text-green-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Progress: ",n,"/5"]}),e.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-green-500 transition-all duration-300",style:{width:`${n/5*100}%`}})})]})]}),g.map((t,o)=>e.jsx(ye,{form:r,questionIndex:o},t.id))]}),e.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("div",{className:"font-medium",children:"Quiz Summary"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total Questions: 5 â€¢ Maximum Score: 5 points"})]}),e.jsx(N,{type:"submit",disabled:m.isPending||n<5,size:"lg",className:"min-w-[200px] bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-medium shadow-lg disabled:opacity-50",children:m.isPending?"Creating Quiz...":r.watch("status")==="published"?"Publish Quiz Now":r.watch("status")==="scheduled"?"Schedule Quiz":"Save as Draft"})]})})]})})})},Ae=()=>e.jsx("div",{className:"min-h-screen text-foreground",style:{background:"linear-gradient(135deg, #190749 0%, #070215 100%)"},children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(ce,{to:"/quiz",className:"inline-flex items-center gap-2 text-sm text-gray-300 hover:text-white mb-6 transition-colors duration-200 hover:bg-white/10 px-3 py-2 rounded-md",children:[e.jsx(de,{className:"h-4 w-4"}),"Back to Quizzes"]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl shadow-lg border border-white/20 p-8 mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 text-white",children:"Create New Quiz"}),e.jsx("p",{className:"text-gray-300 text-lg",children:"Design an engaging 5-question daily quiz for WoDaGOAT users"})]}),e.jsx(ze,{})]})})});export{Ae as default};
