import{c as Y,r as J,j as e,l as _,m as z,ab as C,a4 as V,aq as X,ar as ce,n as k,z as P,w as de,as as xe,B as f,T as b,at as me,au as he,L as R,a as D,s as L,av as Z,aw as ge,A as ue,g as be,i as ye,a5 as v,S as ee,af as se,k as fe,ae as O,u as je,e as pe,ax as Ne,o as we,J as G,a6 as ve}from"./index-D6Dh-tOY.js";import{C as I,R as _e,a as ze}from"./radio-group-C3QFr_Z3.js";import{S as N,a as T,T as Ce}from"./target-Bezeda79.js";import{a as ke}from"./BadgeCard-UnCSqldB.js";import{B as qe}from"./BadgeShowcase-D8TwguRA.js";import{F as S}from"./flame-DVX3-eVT.js";import{T as w}from"./trending-up-C7CvnSET.js";import{R as Se,L as Le,C as Qe,X as Ae,Y as Be,T as $e,a as De}from"./LineChart-CXZp6k_F.js";import{u as Te}from"./useUserQuizAttempts-DN2PSnCZ.js";import"./tooltip-Bvq1edap.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=Y("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=Y("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]),Re=({quiz:s,onSubmit:a})=>{const[r,t]=J.useState({}),n=s.quiz_questions.sort((m,h)=>m.order-h.order),l=(m,h)=>{t(c=>({...c,[m]:h}))},i=()=>{a(r)},o=Object.keys(r).length,x=n.length===5&&o===5,j=o/5*100;return e.jsxs(_,{className:"w-full max-w-3xl mx-auto bg-gray-800/60 border-gray-700 text-white",children:[e.jsxs(z,{className:"text-center",children:[e.jsx(C,{className:"text-3xl font-bold text-primary",children:s.title}),e.jsx(V,{className:"text-gray-300",children:s.topic}),e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Progress"}),e.jsxs("span",{className:"font-semibold text-primary",children:[o,"/5 Questions"]})]}),e.jsx(X,{value:j,className:"w-full h-2"}),e.jsx("div",{className:"flex justify-center gap-2",children:Array.from({length:5},(m,h)=>e.jsx("div",{className:"flex items-center",children:h<o?e.jsx(I,{className:"h-5 w-5 text-green-500"}):e.jsx(ce,{className:"h-5 w-5 text-gray-500"})},h))})]})]}),e.jsx(k,{className:"space-y-8",children:n.map((m,h)=>{const c=r[m.id];return e.jsxs("div",{className:P("p-4 rounded-lg border transition-all",c?"border-green-500/50 bg-green-500/10":"border-gray-600"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("p",{className:"font-semibold text-lg flex-1",children:[e.jsxs("span",{className:"text-primary mr-2",children:[h+1,"."]}),m.question_text]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("span",{className:"text-xs text-gray-400 bg-gray-700 px-2 py-1 rounded",children:"1 point"}),c&&e.jsx(I,{className:"h-5 w-5 text-green-500"})]})]}),e.jsx(_e,{onValueChange:u=>l(m.id,u),value:r[m.id]||"",children:e.jsx("div",{className:"space-y-3",children:m.quiz_answers.map(u=>e.jsxs("div",{className:P("flex items-center space-x-3 p-3 rounded-lg border border-gray-600 transition-all hover:border-gray-500",r[m.id]===u.id&&"bg-blue-500/20 border-blue-400"),children:[e.jsx(ze,{value:u.id,id:u.id,className:"text-primary border-gray-500"}),e.jsx(de,{htmlFor:u.id,className:"flex-1 cursor-pointer",children:u.answer_text})]},u.id))})})]},m.id)})}),e.jsxs(xe,{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"text-center text-sm text-gray-400",children:[!x&&e.jsx("p",{children:"Answer all 5 questions to submit your quiz"}),x&&e.jsx("p",{className:"text-green-400 font-semibold",children:"Ready to submit! Maximum score: 5 points"})]}),e.jsx(f,{onClick:i,disabled:!x,size:"lg",className:"w-full",children:x?"Submit Quiz (5/5 Complete)":`Continue (${o}/5)`})]})]})},Ee=({score:s,totalQuestions:a})=>{const t=Math.min(s,5),n=Math.round(t/5*100),l=()=>t===5?"Perfect Score! 🐐":t>=4?"Excellent! 🏆":t>=3?"Good Job! 👏":t>=2?"Not Bad! 👍":"Keep Practicing! 💪",i=()=>t===5?"text-yellow-400":t>=4?"text-green-400":t>=3?"text-blue-400":t>=2?"text-orange-400":"text-gray-400";return e.jsxs(_,{className:"w-full max-w-2xl mx-auto bg-gray-800/60 border-gray-700 text-white",children:[e.jsx(z,{children:e.jsxs(C,{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(b,{className:"h-6 w-6 text-yellow-500"}),e.jsx("span",{className:"text-3xl font-bold text-primary",children:"Daily Quiz Complete!"})]}),e.jsx("p",{className:`text-xl font-semibold ${i()}`,children:l()})]})}),e.jsxs(k,{className:"text-center space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-6xl font-bold text-primary mb-2",children:[t," ",e.jsx("span",{className:"text-2xl text-gray-400",children:"/ 5"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{value:n,className:"w-full h-3"}),e.jsxs("p",{className:"text-xl font-semibold text-primary",children:[n,"%"]})]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-2 max-w-xs mx-auto",children:Array.from({length:5},(o,x)=>e.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                ${x<t?"bg-green-500 text-white":"bg-gray-600 text-gray-300"}`,children:x+1}),e.jsx("div",{className:"text-xs text-gray-400",children:x<t?"✓":"✗"})]},x))}),e.jsxs("div",{className:"flex justify-center gap-8 py-4 border-t border-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"text-green-500 h-5 w-5"}),e.jsxs("span",{className:"font-semibold",children:[t," Correct"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"text-red-500 h-5 w-5"}),e.jsxs("span",{className:"font-semibold",children:[5-t," Incorrect"]})]})]}),e.jsx("div",{className:"bg-white/5 rounded-lg p-4",children:t===5?e.jsx("p",{className:"text-sm text-gray-300",children:"🎉 Perfect score! You're a true sports GOAT! Come back tomorrow for another challenge."}):t>=3?e.jsxs("p",{className:"text-sm text-gray-300",children:["Great work! You scored ",t," out of 5. Keep up the momentum with tomorrow's quiz!"]}):e.jsx("p",{className:"text-sm text-gray-300",children:"Don't give up! Every quiz makes you stronger. Try again tomorrow to improve your streak!"})}),e.jsx(R,{to:"/",children:e.jsx(f,{size:"lg",className:"mt-4",children:"Back to Home"})})]})]})},Fe=(s=50,a=0)=>D({queryKey:["quizLeaderboard",s,a],queryFn:async()=>{console.log(`Fetching quiz leaderboard with limit: ${s}, offset: ${a}`);const{data:r,error:t}=await L.rpc("get_quiz_leaderboard_optimized",{p_limit:s,p_offset:a});if(t)throw console.error("Error fetching quiz leaderboard:",t),new Error(t.message);if(!r)return[];const n=r.map(l=>({user_id:l.user_id,full_name:l.full_name||"Anonymous",avatar_url:l.avatar_url,total_score:Number(l.total_score),quizzes_completed:Number(l.quizzes_completed),highest_badge_id:l.highest_badge_id,highest_badge_name:l.highest_badge_name,highest_badge_rarity:l.highest_badge_rarity}));return console.log(`Quiz leaderboard fetched: ${n.length} users`),n},staleTime:1e3*60*5}),Pe={lightbulb:ge,sparkles:N,trophy:b,shield:T,book:ke},M={common:"text-green-400",rare:"text-blue-400",epic:"text-purple-400",legendary:"text-yellow-400"},A=["bg-yellow-500/30","bg-gray-400/30","bg-amber-500/30"],B=["border-yellow-400/50","border-gray-300/50","border-amber-500/50"];function W(s){return Z.getBadge(s)}function Oe(s){return Pe[s.icon]||N}function H(s){return M[s]||M.common}function p(s){return s===1?{icon:b,bgColor:A[0],borderColor:B[0],textColor:"text-yellow-400",label:"Quiz Champion"}:s===2?{icon:b,bgColor:A[1],borderColor:B[1],textColor:"text-gray-300",label:"2nd Place"}:s===3?{icon:b,bgColor:A[2],borderColor:B[2],textColor:"text-amber-500",label:"3rd Place"}:{icon:null,bgColor:"bg-gray-600/30",borderColor:"border-gray-500/50",textColor:"text-gray-300",label:`Rank #${s}`}}Z.getBadgeStats();const Ge=({user:s,rank:a})=>{var l;console.log(`QuizLeaderboardRow for user ${s.user_id} at rank ${a}:`,{highest_badge_id:s.highest_badge_id,highest_badge_name:s.highest_badge_name,highest_badge_rarity:s.highest_badge_rarity});const r=()=>{if(s.highest_badge_id){const o=W(s.highest_badge_id);if(o){const x=Oe(o),j=H(s.highest_badge_rarity||"common");return console.log(`Displaying badge icon for ${o.name} with rarity ${o.rarity}`),e.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full border-2 ${a<=3?p(a).bgColor:"bg-gray-600/30"} ${a<=3?p(a).borderColor:"border-gray-500/50"}`,children:e.jsx(x,{size:24,className:j,strokeWidth:2})})}}const i=p(a);if(console.log(`Using rank fallback for rank ${a}`),i.icon){const o=i.icon;return e.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full border-2 ${i.bgColor} ${i.borderColor}`,children:e.jsx(o,{size:24,className:i.textColor,strokeWidth:2,fill:"currentColor"})})}return e.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full border-2 ${i.bgColor} ${i.borderColor}`,children:e.jsx("span",{className:`font-bold text-lg ${i.textColor}`,children:a})})},t=a<=3?`${p(a).bgColor.replace("/30","/10")} border-l-4 ${p(a).borderColor}`:"hover:bg-white/5",n=()=>{if(console.log("getBadgeDisplay called with:",{badge_id:s.highest_badge_id,badge_name:s.highest_badge_name,badge_rarity:s.highest_badge_rarity}),s.highest_badge_id&&s.highest_badge_name){W(s.highest_badge_id);const o=H(s.highest_badge_rarity||"common");return console.log(`Displaying badge: ${s.highest_badge_name} with rarity: ${s.highest_badge_rarity}`),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(v,{className:`w-3 h-3 ${o}`}),e.jsx("span",{className:`text-sm ${o}`,children:s.highest_badge_name})]})}const i=p(a);return console.log(`No badge found, using rank fallback: ${i.label}`),e.jsx("span",{className:`text-sm ${i.textColor}`,children:i.label})};return e.jsxs("div",{className:`grid grid-cols-[80px_1fr_120px_120px] items-center p-3 transition-colors duration-200 ${t}`,children:[e.jsx("div",{className:"flex items-center justify-center min-h-[48px]",children:r()}),e.jsxs(R,{to:`/users/${s.user_id}`,className:"flex items-center gap-4 group overflow-hidden",children:[e.jsxs(ue,{className:"h-10 w-10 border-2 border-white/20",children:[e.jsx(be,{src:s.avatar_url||void 0,alt:s.full_name||"User"}),e.jsx(ye,{children:((l=s.full_name)==null?void 0:l.charAt(0))||"U"})]}),e.jsxs("div",{className:"truncate",children:[e.jsx("p",{className:"font-semibold text-white group-hover:underline truncate",children:s.full_name||"Anonymous User"}),n()]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-xl text-blue-300",children:s.total_score}),e.jsx("p",{className:"text-xs text-gray-400",children:"Total Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-xl text-green-300",children:s.quizzes_completed}),e.jsx("p",{className:"text-xs text-gray-400",children:"Quizzes Taken"})]})]})},Ie=()=>{const{data:s,isLoading:a,isError:r}=Fe();return a?e.jsx("div",{className:"space-y-2 max-w-4xl mx-auto",children:[...Array(10)].map((t,n)=>e.jsx(ee,{className:"h-[76px] w-full bg-white/5 rounded-lg"},n))}):r?e.jsx("p",{className:"text-center text-red-400 max-w-4xl mx-auto py-10",children:"Failed to load the leaderboard. Please try again later."}):!s||s.length===0?e.jsx("p",{className:"text-center text-gray-400 max-w-4xl mx-auto py-10",children:"No one has taken any quizzes yet. Be the first!"}):e.jsxs(_,{className:"bg-white/5 border-white/10 text-white max-w-4xl mx-auto",children:[e.jsx(z,{className:"border-b border-white/10",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{className:"h-8 w-8 text-yellow-400"}),e.jsxs("div",{children:[e.jsx(C,{className:"text-2xl font-bold",children:"Quiz Leaderboard"}),e.jsx(V,{className:"text-gray-400",children:"Top players based on total quiz scores."})]})]})}),e.jsx(k,{className:"p-0",children:e.jsxs("div",{className:"divide-y divide-white/10",children:[e.jsxs("div",{className:"grid grid-cols-[60px_1fr_120px_120px] items-center p-3 text-xs uppercase text-gray-400 font-bold tracking-wider",children:[e.jsx("div",{className:"text-center",children:"Rank"}),e.jsx("div",{className:"pl-4",children:"Player"}),e.jsx("div",{className:"text-center",children:"Total Score"}),e.jsx("div",{className:"text-center",children:"Quizzes"})]}),s.map((t,n)=>e.jsx(Ge,{user:t,rank:n+1},t.user_id))]})})]})},$=({stats:s})=>{const{userBadges:a}=se(),t=(()=>{const l=[{id:"goat",name:"GOAT",color:"bg-yellow-500",icon:w},{id:"legend",name:"Legend",color:"bg-purple-500",icon:T},{id:"expert",name:"Expert",color:"bg-blue-500",icon:U},{id:"triple_perfect",name:"Hat Trick",color:"bg-orange-500",icon:v},{id:"perfect_score",name:"Perfect Score",color:"bg-green-500",icon:b},{id:"streak_10",name:"10-Day Streak",color:"bg-red-500",icon:S},{id:"foot_lover",name:"Foot Lover",color:"bg-green-500",icon:O},{id:"streak_3",name:"3-Day Streak",color:"bg-orange-400",icon:S},{id:"first_quiz",name:"First Quiz",color:"bg-blue-400",icon:N},{id:"newcomer",name:"Newcomer",color:"bg-gray-500",icon:N}];for(const o of l)if(a.some(j=>j.badge_id===o.id))return o;const i=s.accuracy_percentage;return i>=90?{name:"GOAT",color:"bg-yellow-500",icon:w}:i>=75?{name:"Legend",color:"bg-purple-500",icon:T}:i>=60?{name:"Expert",color:"bg-blue-500",icon:U}:i>=45?{name:"Foot Lover",color:"bg-green-500",icon:O}:{name:"Newcomer",color:"bg-gray-500",icon:N}})(),n=t.icon;return e.jsxs(_,{className:"bg-gradient-to-br from-slate-800 to-slate-900 border-blue-500/30 text-white shadow-xl",children:[e.jsx(z,{className:"pb-4",children:e.jsxs(C,{className:"text-xl flex items-center gap-3 text-white",children:[e.jsx(b,{className:"h-6 w-6 text-yellow-500"}),"Your Daily Quiz Performance"]})}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-blue-300 text-base",children:"Current Level:"}),e.jsxs(fe,{className:`${t.color} text-white px-4 py-2 text-base font-semibold flex items-center gap-2`,children:[e.jsx(n,{className:"h-4 w-4"}),t.name]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(Ce,{className:"h-6 w-6 text-blue-400"})}),e.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[s.accuracy_percentage.toFixed(1),"%"]}),e.jsx("div",{className:"text-blue-300 text-sm",children:"Accuracy"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(S,{className:"h-6 w-6 text-orange-400"})}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s.current_streak}),e.jsx("div",{className:"text-blue-300 text-sm",children:"Day Streak"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(v,{className:"h-6 w-6 text-yellow-400"})}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s.perfect_scores}),e.jsx("div",{className:"text-blue-300 text-sm",children:"Perfect 5/5"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(w,{className:"h-6 w-6 text-green-400"})}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s.total_quizzes}),e.jsx("div",{className:"text-blue-300 text-sm",children:"Daily Quizzes"})]})]}),e.jsx("div",{className:"border-t border-gray-600 pt-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold text-white mb-2",children:[s.total_correct," / ",s.total_questions," Questions Correct"]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Each daily quiz has exactly 5 questions worth 1 point each"})]})}),a.length>0&&e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Badges Earned"}),e.jsxs("div",{className:"text-lg font-bold text-blue-400",children:[a.length," badge",a.length!==1?"s":""]})]}),s.longest_streak>s.current_streak&&e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Best Streak"}),e.jsxs("div",{className:"text-lg font-bold text-orange-400 flex items-center justify-center gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),s.longest_streak," days"]})]})]})]})},Ue=({data:s})=>{const a=s.slice(-10);return e.jsxs(_,{className:"w-full",children:[e.jsx(z,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5 text-blue-500"}),"Recent Performance"]})}),e.jsx(k,{children:e.jsx("div",{className:"h-64",children:e.jsx(Se,{width:"100%",height:"100%",children:e.jsxs(Le,{data:a,children:[e.jsx(Qe,{strokeDasharray:"3 3",stroke:"#e0e7ff"}),e.jsx(Ae,{dataKey:"date",tick:{fontSize:12},tickFormatter:r=>new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(Be,{domain:[0,100],tick:{fontSize:12},tickFormatter:r=>`${r}%`}),e.jsx($e,{formatter:r=>[`${r}%`,"Score"],labelFormatter:r=>new Date(r).toLocaleDateString()}),e.jsx(De,{type:"monotone",dataKey:"percentage",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2}})]})})})})]})},Ke=async()=>{const s=new Date().toISOString().split("T")[0],{data:a,error:r}=await L.from("quizzes").select("*, quiz_questions(*, quiz_answers(*))").eq("active_date",s).maybeSingle();if(r)throw new Error(r.message);return a},Me=async(s,a)=>{if(!s||!a)return null;const{data:r,error:t}=await L.from("quiz_attempts").select("*").eq("user_id",s).eq("quiz_id",a).maybeSingle();if(t)throw new Error(t.message);return r},as=()=>{const{user:s,loading:a}=je(),r=pe(),[t,n]=J.useState("quiz"),{stats:l,loading:i}=Ne(),{data:o,isLoading:x}=Te(),{userBadges:j,loading:m,refreshBadges:h}=se(),{data:c,isLoading:u,isError:te}=D({queryKey:["todaysQuiz"],queryFn:Ke,retry:1}),{data:E,isLoading:ae}=D({queryKey:["userAttempt",s==null?void 0:s.id,c==null?void 0:c.id],queryFn:()=>Me(s.id,c.id),enabled:!!s&&!!c}),re=we({mutationFn:async({score:d,answers:g})=>{if(!s||!c)throw new Error("User or quiz not found");console.log("Saving quiz attempt for user:",s.id,"with score:",d);const{error:y}=await L.from("quiz_attempts").insert({user_id:s.id,quiz_id:c.id,score:d,answers:g,started_at:new Date().toISOString()});if(y)throw new Error(y.message);console.log("Quiz attempt saved successfully")},onSuccess:async()=>{G.success("Quiz submitted successfully!"),r.invalidateQueries({queryKey:["userAttempt",s==null?void 0:s.id,c==null?void 0:c.id]}),r.invalidateQueries({queryKey:["userQuizAttempts",s==null?void 0:s.id]}),r.invalidateQueries({queryKey:["userStats",s==null?void 0:s.id]}),h&&setTimeout(()=>{h()},1e3)},onError:d=>{G.error(`Failed to save quiz attempt: ${d.message}`)}}),le=d=>{let g=0;c==null||c.quiz_questions.forEach(y=>{const q=y.quiz_answers.find(Q=>Q.is_correct);q&&d[y.id]===q.id&&g++}),re.mutate({score:g,answers:d})},ie=()=>{const d=new Date,g=new Date(d);g.setDate(g.getDate()+1),g.setHours(0,0,0,0);const y=g.getTime()-d.getTime(),q=Math.floor(y/(1e3*60*60)),Q=Math.floor(y%(1e3*60*60)/(1e3*60));return`${q}h ${Q}m`},oe=(o==null?void 0:o.map(d=>{var g;return{date:d.completed_at,score:d.score,percentage:(g=d.quizzes)!=null&&g.quiz_questions?d.score/d.quizzes.quiz_questions.length*100:0}}))||[],F=()=>a||u||ae?e.jsx(ee,{className:"h-[400px] w-full max-w-4xl mx-auto bg-white/5"}):s?te?e.jsx("p",{className:"text-center text-red-400 text-lg",children:"Could not load quiz. Please try again later."}):c?E?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ee,{score:E.score,totalQuestions:c.quiz_questions.length}),l&&e.jsx($,{stats:l}),s&&e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 border border-white/20",children:[e.jsx(f,{onClick:h,className:"w-full",variant:"outline",children:"🏆 Check for New Badges"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"Click to check if you've earned any new badges"})]})]}):e.jsx(Re,{quiz:c,onSubmit:le}):e.jsxs("div",{className:"text-center text-white max-w-md mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"No Quiz Today!"}),e.jsx("p",{className:"text-lg text-gray-300 mb-4",children:"Check back tomorrow for a new challenge."}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 border border-white/20 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(ve,{className:"h-5 w-5 text-blue-400"}),e.jsx("span",{className:"font-semibold",children:"Next Quiz In:"})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:ie()})]}),e.jsx(R,{to:"/",children:e.jsx(f,{children:"Go Home"})})]}):e.jsxs("div",{className:"text-center text-white max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"🎯 Ready for the Challenge?"}),e.jsx("p",{className:"text-lg text-gray-300 mb-6",children:"Join WoDaGOAT and test your sports knowledge with our daily quizzes!"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Why Take Our Quizzes?"}),e.jsxs("ul",{className:"text-left space-y-2 text-gray-300",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-yellow-400"}),"Earn badges and climb the leaderboard"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-blue-400"}),"Daily challenges to test your knowledge"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4 text-purple-400"}),"Unlock achievements and track your progress"]})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-4",children:"Sign up now to start your journey to becoming the ultimate sports GOAT!"})]})]}),ne=()=>t==="quiz"?e.jsxs("div",{className:"space-y-6",children:[s&&l&&!i&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:F()}),e.jsx("div",{children:e.jsx($,{stats:l})})]}),(!s||i)&&F()]}):t==="badges"?e.jsx(qe,{userBadges:j}):t==="progress"?e.jsxs("div",{className:"space-y-6",children:[l&&e.jsx($,{stats:l}),e.jsx(Ue,{data:oe})]}):e.jsx(Ie,{});return e.jsx("div",{className:"py-8 px-4 flex flex-col flex-grow min-h-screen",style:{background:"linear-gradient(135deg, #190749 0%, #070215 100%)"},children:e.jsxs("div",{className:"container mx-auto flex-grow max-w-6xl",children:[e.jsxs("div",{className:"flex flex-wrap justify-center mb-8 gap-2",children:[e.jsxs(f,{onClick:()=>n("quiz"),variant:t==="quiz"?"default":"secondary",className:"flex-1 sm:flex-none sm:w-40 bg-white/10 border-white/20 text-white hover:bg-white/20 data-[state=active]:bg-blue-600",style:t==="quiz"?{backgroundColor:"#3b82f6"}:{},children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Daily Quiz"]}),e.jsxs(f,{onClick:()=>n("leaderboard"),variant:t==="leaderboard"?"default":"secondary",className:"flex-1 sm:flex-none sm:w-40 bg-white/10 border-white/20 text-white hover:bg-white/20 data-[state=active]:bg-blue-600",style:t==="leaderboard"?{backgroundColor:"#3b82f6"}:{},children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),"Leaderboard"]}),e.jsxs(f,{onClick:()=>n("badges"),variant:t==="badges"?"default":"secondary",className:"flex-1 sm:flex-none sm:w-40 bg-white/10 border-white/20 text-white hover:bg-white/20 data-[state=active]:bg-blue-600",style:t==="badges"?{backgroundColor:"#3b82f6"}:{},children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Badges"]}),e.jsxs(f,{onClick:()=>n("progress"),variant:t==="progress"?"default":"secondary",className:"flex-1 sm:flex-none sm:w-40 bg-white/10 border-white/20 text-white hover:bg-white/20 data-[state=active]:bg-blue-600",style:t==="progress"?{backgroundColor:"#3b82f6"}:{},children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Progress"]})]}),ne()]})})};export{as as default};
